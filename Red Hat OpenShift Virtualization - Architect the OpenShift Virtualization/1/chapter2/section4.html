<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Proof of Technology (PoT) Environment :: Architect the OpenShift Virtualization</title>
    <link rel="prev" href="section3.html">
    <link rel="next" href="../chapter3/index.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Architect the OpenShift Virtualization</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/architect-the-ocpvirt/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="Red Hat OpenShift Virtualization - Architect the OpenShift Virtualization" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Architect the OpenShift Virtualization</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter1/index.html">Requirements of OpenShift Virtualization for Migration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section1.html">Review of current VM environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section2.html">Technical OpenShift Virtualization Questions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section3.html">Current Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section4.html">Workload Migration Complexity Analysis</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Recommended Migration Approach</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section1.html">Virtualization Migration Assessment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.html">Pilot Foundation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section3.html">Expand with Migration Factory</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="section4.html">Proof of Technology (PoT) Environment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter3/index.html">Reference Design and Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section1.html">Red Hat OpenShift Virtualization High-Level Design</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section2.html">Physical Cluster Design</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section3.html">Micro Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section4.html">Small Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section5.html">Medium Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section6.html">Large Cluster</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter4/index.html">Reference Implementation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter4/section1.html">Cluster Deployment Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter4/section2.html">Post-install Configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter5/index.html">Additional Features</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter5/section1.html">section1.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter5/section2.html">section2.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter5/section3.html">section3.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter5/section4.html">section4.adoc</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter6/index.html">OpenShift Virtualization Sizing for Virtual Machines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter6/section1.html">section1.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter6/section2.html">section2.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter6/section3.html">section3.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter6/section4.html">section4.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter6/section5.html">section5.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter6/section6.html">section6.adoc</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Architect the OpenShift Virtualization</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Architect the OpenShift Virtualization</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Architect the OpenShift Virtualization</a></li>
    <li><a href="index.html">Recommended Migration Approach</a></li>
    <li><a href="section4.html">Proof of Technology (PoT) Environment</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Proof of Technology (PoT) Environment</h1>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Prior to beginning the pilot phase in earnest, a proof of technology environment will be implemented by the financial company&#8217;s team with support from Red Hat. This environment will prove the reliability of the proposed cluster architecture as it would be implemented inside of the financial company&#8217;s network and datacenter constraints. The environment will also be retained to serve as  the infrastructure sandbox or lab environment where configurations and automations can be developed, tested, and evaluated for security and compliance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/PoT_environment.png" alt="PoT environment">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_foundation_cluster"><a class="anchor" href="#_foundation_cluster"></a>Foundation Cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This cluster will host the control plane pods for the workload cluster(s) in the PoT environment as well as other management tooling as needed. The management tools expected to be installed for PoT evaluation are Advanced Cluster Management for Kubernetes (ACM), Ansible Automation Platform (AAP), OpenShift GitOps, and OpenShift cert-manager Operator or functional equivalents.
Combining OpenShift control planes and management workloads onto a foundation cluster in this manner minimizes the overhead of OpenShift when running large numbers of clusters and provides a single point of management for performing deployment and maintenance of the OpenShift clusters within a datacenter or pod.</p>
</div>
<div class="sect2">
<h3 id="_hardware"><a class="anchor" href="#_hardware"></a>Hardware</h3>
<div class="paragraph">
<p>The foundation cluster will consist of three physical nodes deployed across failure domains (racks). While smaller nodes can be used for the PoT environment, the proposed architecture calls for foundation cluster nodes to be similar in sizing to the workload cluster nodes and existing vSphere hypervisors to improve control plane density. Existing vSphere nodes can be repurposed for this use case provided they meet the local storage requirements below.</p>
</div>
</div>
<div class="sect2">
<h3 id="_networking"><a class="anchor" href="#_networking"></a>Networking</h3>
<div class="paragraph">
<p>Assuming existing hardware is repurposed, each foundation cluster node will have four network interfaces consisting of two slower interfaces (1G) and two fast interfaces (10/25G). The two slower interfaces should be configured as a bonded pair connected to the out of band (OOB) management network to facilitate virtual media provisioning of servers. The two faster interfaces should be configured as a bonded pair connected to the management network within the VMSN zone. This interface will carry the control plane traffic for the workload clusters and traffic for the management tools.
An LACP-based link aggregation configuration (MLAG or vPC) is recommended for the bonded interfaces but less important for the slower interfaces than the faster interfaces.
Each server is also expected to have an OOB management interface which will be used for operating system provisioning and also for fencing to expedite workload recovery in the event of a node failure. If this OOB network is not in the VMSN zone, then firewall rules will be needed to allow access from the management network to the OOB interfaces by HTTPS and vice-versa.</p>
</div>
</div>
<div class="sect2">
<h3 id="_storage"><a class="anchor" href="#_storage"></a>Storage</h3>
<div class="paragraph">
<p>Unlike the workload clusters, the foundation cluster will primarily depend on local flash storage for storing persistent control plane data. This provides improved performance for etcd as well as protection of the control planes in the event of an outage to the shared storage. The control plane workloads replicate state across the failure domains in the foundation cluster to provide resilience.
This local storage should consist of one or more solid state disks (ideally NVMe-based) in each foundation cluster in addition to their mirrored boot disks.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_workload_clusters"><a class="anchor" href="#_workload_clusters"></a>Workload Clusters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The initial PoT environment should have one workload cluster. The workload cluster will run the actual virtual machine workloads in OpenShift Virtualization as well as the Migration Toolkit for Virtualization components to migrate virtual machines from the vSphere environment.
Additional workload clusters may be created in the environment by adding additional physical servers managed by the foundation cluster. While virtualized workload clusters are supported by this architecture, they are out of scope for the initial virtual machine migration effort.</p>
</div>
<div class="sect2">
<h3 id="_hardware_2"><a class="anchor" href="#_hardware_2"></a>Hardware</h3>
<div class="paragraph">
<p>The number of servers required for a viable workload cluster depends on the desired separation of failure domains. The cluster may be deployed across two or three failure domains as desired. If storage is shared across the failure domains then one physical node is required per failure domain. If storage is isolated (i.e. SPOF A and SPOF B) then two physical nodes are required per failure domain to evaluate all platform functionality.
Each server should be equivalent in hardware to existing vSphere hypervisor hosts and existing hosts may be repurposed for this use case.</p>
</div>
</div>
<div class="sect2">
<h3 id="_networking_2"><a class="anchor" href="#_networking_2"></a>Networking</h3>
<div class="paragraph">
<p>Assuming existing hardware is repurposed, each foundation cluster node will have four network interfaces consisting of two slower interfaces (1G) and two fast interfaces (10/25G). The two slower interfaces should be configured as a bonded pair connected to the management network within the VMSN zone. The management network will carry control plane and system agent traffic from the OpenShift host. The two faster interfaces should be configured as a bonded pair acting as a trunked connection for storage, migration, and virtual machine VLAN segments.
An LACP-based link aggregation configuration (MLAG or vPC) is recommended for the bonded interfaces but less important for the slower interfaces than the faster interfaces.
Each server is also expected to have an OOB management interface which will be used for operating system provisioning and also for fencing to expedite workload recovery in the event of a node failure. If this OOB network is not in the VMSN zone, then firewall rules will be needed to allow access from the management network to the OOB interfaces by HTTPS and vice-versa.</p>
</div>
</div>
<div class="sect2">
<h3 id="_storage_2"><a class="anchor" href="#_storage_2"></a>Storage</h3>
<div class="paragraph">
<p>The workload cluster nodes will only need a small (120 GB minimum) pair of mirrored solid state disks for operating system and pod ephemeral storage use. The minimum supported size is suitable for a mostly standard OpenShift deployment provisioning virtual machines using images stored on remote storage; however additional space may be needed if many third-party agents are used or if container images are used to distribute virtual machine disk “golden” images. That additional space will depend on the size of the additional images to be stored in ephemeral storage.
Storage for virtual machine workloads is assumed to be Dell PowerFlex or other remote storage accessed over the IP network. If converged storage is desired for testing vSAN-style deployments, then additional solid state disks should be added for OpenShift Data Foundation (ODF).</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="section3.html">Expand with Migration Factory</a></span>
  <span class="next"><a href="../chapter3/index.html">Reference Design and Architecture</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
